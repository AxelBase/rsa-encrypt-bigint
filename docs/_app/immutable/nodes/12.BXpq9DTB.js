import{a as _,f as S,t as se}from"../chunks/BMiMyIra.js";import"../chunks/ByVR1gH1.js";import{aQ as oe,aR as ie,M as de,ar as ve,h as ce,l as g,aS as ue,a9 as fe,_ as M,d as f,aa as me,a4 as i,$ as v,a5 as d,a1 as I,aT as p,w as k,aU as Q}from"../chunks/B4JTICGB.js";import{e as be,s as pe}from"../chunks/CDsDeF4v.js";import{i as L}from"../chunks/D32U0xC1.js";import{t as h,f as U,a as N}from"../chunks/BFpDmOgY.js";import{r as W,s as F,a as j}from"../chunks/Dgs-8_m5.js";import{i as ye}from"../chunks/DSBpFr32.js";import{b as X}from"../chunks/D0U-WUXM.js";function _e(e,a,t=a){var r=new WeakSet;oe(e,"input",async s=>{var n=s?e.defaultValue:e.value;if(n=K(e)?$(n):n,t(n),g!==null&&r.add(g),await ie(),n!==(n=a())){var o=e.selectionStart,c=e.selectionEnd,m=e.value.length;if(e.value=n??"",c!==null){var b=e.value.length;o===c&&c===m&&b>m?(e.selectionStart=b,e.selectionEnd=b):(e.selectionStart=o,e.selectionEnd=Math.min(c,b))}}}),(ce&&e.defaultValue!==e.value||de(a)==null&&e.value)&&(t(K(e)?$(e.value):e.value),g!==null&&r.add(g)),ve(()=>{var s=a();if(e===document.activeElement){var n=ue??g;if(r.has(n))return}K(e)&&s===$(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function K(e){var a=e.type;return a==="number"||a==="range"}function $(e){return e===""?null:+e}function ge(e){return function(...a){var t=a[0];return t.preventDefault(),e?.apply(this,a)}}const he=!0,Oe=Object.freeze(Object.defineProperty({__proto__:null,prerender:he},Symbol.toStringTag,{value:"Module"}));function xe(e){let a=0n;for(let t=0;t<Number(e);t++)a=a<<1n|BigInt(Math.floor(Math.random()*2));return a|1n<<e-1n}function we(e,a,t){let r=1n;for(e=e%t;a>0n;)a%2n===1n&&(r=r*e%t),a=a>>1n,e=e*e%t;return r}function ke(e,a=5n){if(e<=1n||e===4n)return!1;if(e<=3n)return!0;let t=0n,r=e-1n;for(;r%2n===0n;)r/=2n,t+=1n;const s=[2n,3n,5n,7n,11n,13n,23n,29n,31n,37n].slice(0,Number(a));for(let n of s){if(n>=e)break;let o=we(n,r,e);if(o===1n||o===e-1n)continue;let c=!1;for(let m=1n;m<t;m++)if(o=o*o%e,o===e-1n){c=!0;break}if(!c)return!1}return!0}function Y(e){for(;;){let a=xe(e)|1n;if(ke(a))return a}}function q(e,a){if(e===0n)return[a,0n,1n];const[t,r,s]=q(a%e,e);return[t,s-a/e*r,r]}function Se(e,a){const[t,r]=q(e,a);if(t!==1n)throw new Error("No modular inverse");return(r%a+a)%a}function Ee(e=1024n){const a=e/2n,t=Y(a),r=Y(a),s=t*r,n=(t-1n)*(r-1n),o=65537n;if(q(o,n)[0]!==1n)throw new Error("e not coprime");const c=Se(o,n);return{n:s.toString(16),e:o.toString(16),d:c.toString(16)}}var Be=S('<span class="spinner-border spinner-border-sm me-2" role="status"></span> Calculating...',1),Pe=S('<div class="alert alert-danger rounded-4 border-0"><strong>Error:</strong> </div>'),Ge=S('<div class="glass-card p-4 p-md-5 mb-4 border-0"><div class="d-flex align-items-center gap-2 mb-4"><i class="bi bi-shield-lock-fill fs-4" style="color: var(--brand-orange)"></i> <h4 class="fw-bold m-0">Generated Keypair</h4></div> <div class="mb-4 text-start"><label for="n" class="form-label fw-bold small text-uppercase text-muted ms-2">Modulus (n)</label> <textarea class="form-control key-area svelte-1vi3pl9" id="n" rows="3" readonly=""></textarea></div> <div class="row g-3"><div class="col-md-4 text-start"><label for="e" class="form-label fw-bold small text-uppercase text-muted ms-2">Public Exp (e)</label> <input type="text" class="form-control key-area svelte-1vi3pl9" id="e" readonly=""/></div> <div class="col-md-8 text-start"><label for="d" class="form-label fw-bold small text-uppercase text-muted ms-2">Private Exp (d)</label> <textarea class="form-control key-area private-key-glow svelte-1vi3pl9" id="d" rows="1" readonly=""></textarea></div></div> <div class="alert alert-warning border-0 mt-4 rounded-4" style="background: rgba(255, 193, 7, 0.1); color: #856404;"><small><i class="bi bi-exclamation-triangle-fill me-2"></i><strong>Security Note:</strong> Never share your Private Exponent (d) with anyone.</small></div></div>'),Me=S('<div class="container py-5"><div class="text-center mb-5"><h1 class="display-4 fw-bold" style="color: var(--brand-orange)">RSA Key Generation</h1> <p class="text-muted">Generate secure cryptographic parameters using JavaScript BigInt.</p></div> <div class="row justify-content-center"><div class="col-lg-8"><div class="glass-card p-4 mb-4 border-0"><form><div class="mb-4 text-start"><label for="bitLength" class="form-label fw-bold small text-uppercase ms-2">Security Level (Bits)</label> <div class="input-group"><input type="number" class="form-control bubbly-input svelte-1vi3pl9" id="bitLength" min="512" max="2048" required=""/> <button type="submit" class="btn btn-bubbly px-4"><!></button></div> <div id="bitLengthHelp" class="form-text mt-2 ms-2">Standard is 1024. 2048 is more secure but slower.</div></div></form> <!></div> <!> <div class="mt-5 d-flex gap-3 justify-content-center"><a class="btn btn-outline-secondary rounded-pill px-4 hover-float svelte-1vi3pl9">Back to Home</a> <a class="btn btn-outline-secondary rounded-pill px-4 hover-float svelte-1vi3pl9">Go to Encryption</a></div></div></div></div>');function Re(e,a){fe(a,!1);let t=k(1024),r=k({n:"",e:"",d:""}),s=k(""),n=k(!1);async function o(){p(n,!0),p(s,"");try{if(f(t)<512||f(t)>2048)throw new Error("Bit length must be between 512 and 2048");p(r,Ee(BigInt(f(t))))}catch(l){p(s,l.message)}finally{p(n,!1)}}ye();var c=Me(),m=i(c),b=v(m,2),D=i(b),x=i(D),w=i(x),H=i(w),O=v(i(H),2),E=i(O);W(E);var B=v(E,2),Z=i(B);{var ee=l=>{var u=Be();I(),_(l,u)},ae=l=>{var u=se("Generate Keys");_(l,u)};L(Z,l=>{f(n)?l(ee):l(ae,!1)})}d(B),d(O),I(2),d(H),d(w);var te=v(w,2);{var re=l=>{var u=Pe(),y=v(i(u));d(u),M(()=>pe(y,` ${f(s)??""}`)),h(1,u,()=>N,()=>({x:20})),_(l,u)};L(te,l=>{f(s)&&l(re)})}d(x);var R=v(x,2);{var ne=l=>{var u=Ge(),y=v(i(u),2),V=v(i(y),2);Q(V),d(y);var z=v(y,2),G=i(z),A=v(i(G),2);W(A),d(G);var C=v(G,2),J=v(i(C),2);Q(J),d(C),d(z),I(2),d(u),M(()=>{j(V,f(r).n),j(A,f(r).e),j(J,f(r).d)}),h(1,u,()=>N,()=>({y:30,duration:600})),_(l,u)};L(R,l=>{f(r).n&&l(ne)})}var P=v(R,2),T=i(P),le=v(T,2);d(P),d(D),d(b),d(c),M(()=>{B.disabled=f(n),F(T,"href",`${X??""}/`),F(le,"href",`${X??""}/encrypt`)}),h(1,m,()=>U,()=>({duration:800})),_e(E,()=>f(t),l=>p(t,l)),be("submit",w,ge(o)),h(1,x,()=>N,()=>({y:20,duration:800,delay:200})),h(1,P,()=>U,()=>({delay:1e3})),_(e,c),me()}export{Re as component,Oe as universal};
