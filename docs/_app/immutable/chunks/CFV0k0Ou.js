import{_ as m,a0 as y,b as w,a1 as S,j as _,E as f,a2 as E}from"./CZGqv6FW.js";function M(e,n,t=n){var r=new WeakSet;m(e,"input",async a=>{var o=a?e.defaultValue:e.value;if(o=s(e)?v(o):o,t(o),f!==null&&r.add(f),await y(),o!==(o=n())){var i=e.selectionStart,l=e.selectionEnd,c=e.value.length;if(e.value=o??"",l!==null){var u=e.value.length;i===l&&l===c&&u>c?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=i,e.selectionEnd=Math.min(l,u))}}}),(_&&e.defaultValue!==e.value||w(n)==null&&e.value)&&(t(s(e)?v(e.value):e.value),f!==null&&r.add(f)),S(()=>{var a=n();if(e===document.activeElement){var o=E??f;if(r.has(o))return}s(e)&&a===v(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function s(e){var n=e.type;return n==="number"||n==="range"}function v(e){return e===""?null:+e}function N(e){return function(...n){var t=n[0];return t.preventDefault(),e?.apply(this,n)}}function x(e){let n=0n;for(let t=0;t<Number(e);t++)n=n<<1n|BigInt(Math.floor(Math.random()*2));return n|1n<<e-1n}function h(e,n,t){let r=1n;for(e=e%t;n>0n;)n%2n===1n&&(r=r*e%t),n=n>>1n,e=e*e%t;return r}function B(e,n=5n){if(e<=1n||e===4n)return!1;if(e<=3n)return!0;let t=0n,r=e-1n;for(;r%2n===0n;)r/=2n,t+=1n;const a=[2n,3n,5n,7n,11n,13n,23n,29n,31n,37n].slice(0,Number(n));for(let o of a){if(o>=e)break;let i=h(o,r,e);if(i===1n||i===e-1n)continue;let l=!1;for(let c=1n;c<t;c++)if(i=i*i%e,i===e-1n){l=!0;break}if(!l)return!1}return!0}function g(e){for(;;){let n=x(e)|1n;if(B(n))return n}}function d(e,n){if(e===0n)return[n,0n,1n];const[t,r,a]=d(n%e,e);return[t,a-n/e*r,r]}function I(e,n){const[t,r]=d(e,n);if(t!==1n)throw new Error("No modular inverse");return(r%n+n)%n}function P(e=1024n){const n=e/2n,t=g(n),r=g(n),a=t*r,o=(t-1n)*(r-1n),i=65537n;if(d(i,o)[0]!==1n)throw new Error("e not coprime");const l=I(i,o);return{n:a.toString(16),e:i.toString(16),d:l.toString(16)}}function b(e){const t=new TextEncoder().encode(e);let r="0x";for(let a of t)r+=a.toString(16).padStart(2,"0");return BigInt(r)}function D(e,n,t){const r=BigInt("0x"+n),a=BigInt("0x"+t),o=b(e);if(o>=r)throw new Error("Message too large for key");return h(o,a,r).toString(16)}export{M as b,D as e,P as g,N as p};
